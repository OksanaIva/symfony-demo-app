name: msgphp
recipe: lemp

config:
  webroot: public
  database: mariadb

compose:
  - config/lando/compose.yaml

proxy:
  pma:
    - pma.msgphp.lndo.site

services:
  appserver:
    config:
      server: config/lando/nginx.conf
  database:
    portforward: 3307
  pma:
    type: phpmyadmin
  node:
    type: node

tooling:
  sf:
    service: appserver
    description: Run Symfony commands
    cmd:
      - bin/console
  reset-env:
    service: appserver
    description: Reset demo environment
    cmd:
      - bin/reset-env
  build-admin:
    service: node
    description: Build admin interface
    cmd:
      - bin/build-admin
  yarn:
    service: node

events:
  post-start:
    - appserver: "cd $LANDO_MOUNT && composer install"
    - node: "cd $LANDO_MOUNT/admin && yarn install"
